<!doctype html>
<html lang="en-us">
  <head>
    <title>ansible useage // </title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.55.0-DEV" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.f90f5edd436ec7b74ad05479a05705770306911f721193e7845948fb07fe1335.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ansible useage"/>
<meta name="twitter:description" content="基本概念 Tasks：任务，由模板定义的操作列表 Variables：变量 Templates：模板，即使用模板语法的文件 Handlers：处理器 ，当某条件满足时，触发执行的操作 Roles：角色
定制返回信息 official example
modify config bin_ansible_callbacks = True callback_plugins = callback_plugins callback_whitelist = self_logout  task cost time codes
命令行工具 ansible
ansible-playbook
常用 modules  yum fetch copy shell  template 和 wget 下载文件的速度对比 wget 要比 template 快
shell: wget https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker-ce.repo
template: src: templates/docker-ce.repo dest: /etc/yum.repos.d/docker-ce.repo
yum 是否可以 多个一起
优化大量的shell一起执行的速度 回掉脚本 python ansible api ansible 数组写在一行不好看 playbook的YAML格式： 文件的起始： &mdash; 以三个减号开头，也可以不用，不会影响Ansible的运行 注释： # 像Python一样用一个#进行注释 字符串： 可以使用引号或者不使用，即使字符串中含有空格，也不完全使用引号 布尔值： True | False 列表： 列表使用-作为分隔符： - zhangsan - lisi - wangwu 也可以使用内联格式： [zhangsan,lisi,wangwu] 字典： YAML中的字典类似于JSON中的对象，Python中的字典： address: beijing city: beijing state: North 也可以使用内联格式： {address: beijing, city: beijing, state: North} 折行： YAML中使用大于号(&gt;)来标记折行，YAML解释器会把换行符替换为空格： address: &gt; Deadfasdfadf, sdfdsfdsfsd 模块： apt：使用apt包管理工具安装或删除软件包 copy：将一个文件从本地复制到主机上 file：设置文件、符号链接或者目录的属性 service：启动、停止或者重启一个服务 template：从模板生成一个文件并复制到主机上 handler： handler是Ansible提供的条件机制之一。handler和task很类似，但是它只是在被task通知的时候才会执行。 notify: restart nginx handler只会在所有任务执行完后执行。而且即使被通知了多次，它也只会执行一次。handler按照play中定义的顺序 执行，而不是被通知的顺序。"/>

    <meta property="og:title" content="ansible useage" />
<meta property="og:description" content="基本概念 Tasks：任务，由模板定义的操作列表 Variables：变量 Templates：模板，即使用模板语法的文件 Handlers：处理器 ，当某条件满足时，触发执行的操作 Roles：角色
定制返回信息 official example
modify config bin_ansible_callbacks = True callback_plugins = callback_plugins callback_whitelist = self_logout  task cost time codes
命令行工具 ansible
ansible-playbook
常用 modules  yum fetch copy shell  template 和 wget 下载文件的速度对比 wget 要比 template 快
shell: wget https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker-ce.repo
template: src: templates/docker-ce.repo dest: /etc/yum.repos.d/docker-ce.repo
yum 是否可以 多个一起
优化大量的shell一起执行的速度 回掉脚本 python ansible api ansible 数组写在一行不好看 playbook的YAML格式： 文件的起始： &mdash; 以三个减号开头，也可以不用，不会影响Ansible的运行 注释： # 像Python一样用一个#进行注释 字符串： 可以使用引号或者不使用，即使字符串中含有空格，也不完全使用引号 布尔值： True | False 列表： 列表使用-作为分隔符： - zhangsan - lisi - wangwu 也可以使用内联格式： [zhangsan,lisi,wangwu] 字典： YAML中的字典类似于JSON中的对象，Python中的字典： address: beijing city: beijing state: North 也可以使用内联格式： {address: beijing, city: beijing, state: North} 折行： YAML中使用大于号(&gt;)来标记折行，YAML解释器会把换行符替换为空格： address: &gt; Deadfasdfadf, sdfdsfdsfsd 模块： apt：使用apt包管理工具安装或删除软件包 copy：将一个文件从本地复制到主机上 file：设置文件、符号链接或者目录的属性 service：启动、停止或者重启一个服务 template：从模板生成一个文件并复制到主机上 handler： handler是Ansible提供的条件机制之一。handler和task很类似，但是它只是在被task通知的时候才会执行。 notify: restart nginx handler只会在所有任务执行完后执行。而且即使被通知了多次，它也只会执行一次。handler按照play中定义的顺序 执行，而不是被通知的顺序。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/%E8%BF%90%E7%BB%B4/ansible/" />



  </head>
  <body>
    <header class="app-header">
      <a href=""><img class="app-header-avatar" src="/avatar.jpg" alt="John Doe" /></a>
      <h1></h1>
      <p>keep hungry</p>
      <div class="app-header-social">
        
          <a target="_blank" href="https://github.com/xishengcai" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">ansible useage</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jan 1, 0001
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          1 min read
        </div></div>
    </header>
    <div class="post-content">
      

<h2 id="基本概念">基本概念</h2>

<p>Tasks：任务，由模板定义的操作列表
Variables：变量
Templates：模板，即使用模板语法的文件
Handlers：处理器 ，当某条件满足时，触发执行的操作
Roles：角色</p>

<h2 id="定制返回信息">定制返回信息</h2>

<p><a href="https://github.com/ansible/ansible/blob/devel/lib/ansible/plugins/callback/log_plays.py">official example</a></p>

<h3 id="modify-config">modify config</h3>

<pre><code>bin_ansible_callbacks = True
callback_plugins = callback_plugins
callback_whitelist = self_logout
</code></pre>

<p><a href="https://github.com/jlafon/ansible-profile">task cost time codes</a></p>

<h2 id="命令行工具">命令行工具</h2>

<p>ansible</p>

<p>ansible-playbook</p>

<h2 id="常用-modules">常用 modules</h2>

<ul>
<li>yum</li>
<li>fetch</li>
<li>copy</li>
<li>shell</li>
</ul>

<h3 id="template-和-wget-下载文件的速度对比">template 和 wget 下载文件的速度对比</h3>

<p>wget 要比 template 快</p>

<p>shell: wget <a href="https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo">https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</a> -O /etc/yum.repos.d/docker-ce.repo</p>

<p>template:
    src: templates/docker-ce.repo
    dest: /etc/yum.repos.d/docker-ce.repo</p>

<h3 id="yum">yum</h3>

<p>是否可以 多个一起</p>

<h3 id="优化大量的shell一起执行的速度">优化大量的shell一起执行的速度</h3>

<h3 id="回掉脚本">回掉脚本</h3>

<h3 id="python-ansible-api">python ansible api</h3>

<h3 id="ansible-数组写在一行不好看">ansible 数组写在一行不好看</h3>

<h3 id="playbook的yaml格式-https-blog-csdn-net-yongbuyanqidk-article-details-53369197"><a href="https://blog.csdn.net/yongbuyanqidk/article/details/53369197">playbook的YAML格式</a>：</h3>

<p>文件的起始：
   &mdash;          以三个减号开头，也可以不用，不会影响Ansible的运行
注释：
    #           像Python一样用一个#进行注释
字符串：
    可以使用引号或者不使用，即使字符串中含有空格，也不完全使用引号
布尔值：
    True | False
列表：
    列表使用-作为分隔符：
               - zhangsan
               - lisi
               - wangwu
          也可以使用内联格式：
               [zhangsan,lisi,wangwu]
     字典：
          YAML中的字典类似于JSON中的对象，Python中的字典：
               address: beijing
               city: beijing
               state: North
          也可以使用内联格式：
               {address: beijing, city: beijing, state: North}
     折行：
          YAML中使用大于号(&gt;)来标记折行，YAML解释器会把换行符替换为空格：
               address: &gt;
                     Deadfasdfadf,
                     sdfdsfdsfsd
     模块：
          apt：使用apt包管理工具安装或删除软件包
          copy：将一个文件从本地复制到主机上
          file：设置文件、符号链接或者目录的属性
          service：启动、停止或者重启一个服务
          template：从模板生成一个文件并复制到主机上
     handler：
          handler是Ansible提供的条件机制之一。handler和task很类似，但是它只是在被task通知的时候才会执行。
               notify: restart nginx
          handler只会在所有任务执行完后执行。而且即使被通知了多次，它也只会执行一次。handler按照play中定义的顺序                                           执行，而不是被通知的顺序。</p>

<p>2.inventory：描述你的服务器
     Ansible可管理的主机集合叫作inventory。
     add_host
     group_by</p>

<p>     </p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
